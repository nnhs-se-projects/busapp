<!DOCTYPE html>
<html data-bs-theme="dark">
    <head>
        <title>Bus App</title>
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
        <link rel="manifest" href="/manifest.json">
        <link rel="icon" type="image/x-icon" href="/img/busapp-favicon.png">
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Montserrat&display=swap" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" integrity="sha512-Fo3rlrZj/k7ujTnHg4CGR2D7kSs0v4LLanw2qksYuRlEzO+tcaEPQogQ0KaoGN26/zrn20ImR1DfuLWnOo7aBA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
        <link rel="stylesheet" href="/css/index.css">
    </head>
    <body style="background-image: url('<%= data.weather.icon %>')">
        <div class="pageContainer">
            <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
            <div style="height: 0.25rem"></div>

            <%- include('include/navBar'); %>
            <div id="content">
                <%- include('include/indexContent'); %>
            </div>
            <%- include('include/devTools'); %>
        </div>

        <div id="credits">
            <i class="fa-regular fa-circle-xmark" onclick="toggleCredits()" style="position: absolute; z-index: 2; font-size: max(50%, 25px); right: 10px; top: 10px; cursor: pointer"></i>
            <div class="spacer"></div>
            <div class="starWarsContainer">
              <% for(var i = 0; i < 4; i++) { %>
                <p>Pierre Hanlet</p>
                <p>JD Piar</p>
                <p>Varun Vaid</p>
                <p>Maaz Zubair</p>
                <p>Sayee Anand</p>
                <p>Wyatt Barnes</p>
                <p>Kurt Lovisa</p>
                <p>Nolan Yee</p>
                <p>Devam Das</p>
                <p>Ronith Manikonda</p>
                <p>Everett Dombrowski</p>
                <p>Rohan Rao</p>
                <p>Lucas van Laerhoven</p>
                <p>Aidan Malana</p>
                <p>Muhammad Yulbarsov</p>
              <% } %>
            </div>
        </div>
          
        <div id="IOSnotifpopup">
            <div>
                <i class="fa-regular fa-circle-xmark" onclick="document.getElementById('IOSnotifpopup').style.display='none'" style="position: absolute; right: 10px; top: 10px; cursor: pointer"></i>
                <h2>It appears you may be using IOS</h2>
                <p> IOS needs you to add the busapp to the homescreen before enabling
                notifications. If you have already added the Bus App to your homescreen
                previously, remove it and re-add it. Once you have added the Bus App to
                your home screen, press the "Enable Notifications" button from within the
                app.</p>
                <video autoplay muted loop style="max-width: 100%; max-height: 100vh; width: 100%">
                    <source src="img/ios-instructions.mp4" type="video/mp4" />
                </video>
            </div>
        </div>
          
        <!-- Update the value of <% version = 2 %> in this comment when updating the what's new popup to make it appear again on launch -->
        <input type="hidden" id="whatsNewVersion" value="<%=version%>"/>
        <div id="whatsNewPopup"><div> <i class="fa-regular fa-circle-xmark" onclick="hideWhatsNew(<%=version%>)" style="position: absolute; right: 10px; top: 10px; cursor: pointer"></i>
            <h2>What's New</h2>
            <ul>
                <li><p>New Designs! 🖌️</p>
                    <ul>
                        <li>The Bus App has a new icon and logo 🎨</li>
                        <li>Improved 404 page 🩹</li>
                        <li>Whats next: total user interface redesign 📐</li>
                    </ul>
                </li>
                <li><p>Performance Improvements And Better Reliability 🕒</p>
                    <ul>
                        <li>Notifications should now send faster and more efficiently 🔔</li>
                        <li>Pinning a bus with notifications enabled now shows a loading indicator 📌</li>
                        <li>Network indicator on bottom left is 🟢 for fast network, 🟡 for slow network, and 🔴 for offline</li>
                        <li>Multiple security issues were identified and fixed 🔒</li>
                    </ul>
                </li>
                <li><p>Backend Improvements 🧑‍🔧</p>
                    <ul>
                        <li>New backend code ensures fewer conflicts when new changes are added 🦾</li>
                        <li>Bug fixes in admin page make it faster and easier for staff to get you to your bus ⏱️</li>
                    </ul>
                </li>
                <li><p>More responsive announcements 🗣️</p>
                    <ul>
                        <li>The announcement now updates without reloading the page 📡</li>
                        <li>Fixed bug where announcement disappeared randomly 🫥</li>
                    </ul>
                </li>
                <li>Have feedback or ideas? Send us an email at <a href="mailto:busappdevs@proton.me">busappdevs@proton.me</a></li>
            </ul>
            <br />
            <p>- 🚍 The Bus App Team</p>
            <br /><a class="generic-button" onclick="hideWhatsNew(<%=version%>)">Got It!</a>
        </div></div>

        <div id="networkBlocker">
            <i class="fa-solid fa-globe" style="font-size: min(30vw, 40vh); clip-path: polygon(0 0, 100% 0, 100% 100%, 20% 100%, 100% 0, 80% 0, 0 100%);"></i>
            <h3 style="font-size: min(5vw, 10vh); font-family: sans-serif; margin-top: 20px;">No Network</h3>
        </div>

        <div id="networkIndicator"></div>
        <script src="js/pushNotifs.js"></script>
        <script src="/socket.io/socket.io.js"></script>
        <!--script src='js/indexConnect.js'></script-->
        <script src="js/ejs.js"></script>
        <script src="js/networkIndicator.js"></script>
        <script id="getRender" render="<%= render %>" data="<%= JSON.stringify(data) %>" src='js/indexConnect.js'></script>
    </body>
</html>